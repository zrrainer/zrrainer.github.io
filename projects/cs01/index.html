<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Biomarkers for Recent Cannibis Use | Rainer Zhang</title> <meta name="author" content="Rainer Zhang"> <meta name="description" content="A case study"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://zrrainer.github.io/projects/cs01/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?6185d15ea1982787ad7f435576553d64"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Rainer </span>Zhang</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/"></a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Github Repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Biomarkers for Recent Cannibis Use</h1> <p class="post-description">A case study</p> </header> <article> <p>he data we will be using comes from a placebo-controlled, double-blinded, randomized study published by Hoffman et. al. (2021). In the study, volunteers were randomly assigned to smoke a ciggertte containing placebo (0.02%), or 5.9% (low dose) or 13.4% (high dose) THC. Samples of whole blood (WB), oral fluid(OF), breath (BR) are taken before and after smoking. This report aims to determine the most effective and accurate biomarker for recent (3h) cannibis use.</p> <p>This is a group report written as a assignment for my UCSD COGS 108 Practical Data Sicence in R course. The co-authors are Eddie Ho and Derek Nguyen. The code for the full report can be found <a href="https://github.com/zrrainer/cannibis-biomarker-case-study/tree/main" rel="external nofollow noopener" target="_blank">here</a>, this markdown file is more of a brief overview.</p> <p>After some wrangling, a quick EDA plotting measurements over time, such as these ones:</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset=" /_includes%5CMOVERTcbd-480.webp 480w, /_includes%5CMOVERTcbd-800.webp 800w, /_includes%5CMOVERTcbd-1400.webp 1400w, " sizes="95vw" type="image/webp"></source> <img src="/_includes%5CMOVERTcbd.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="example image" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p><img src="_projects\cs01assets\MOVERTcbd.png" alt=""> <img src="_projects\cs01assets\movertcbn.png" alt=""> <img src="_projects\cs01assets\movertTHCCOOH.png" alt=""></p> <p>Now we needed something to quantify how well a given cutoff works for any specific biomarker. With a helper function that takes in a cutoff as a parameter and return that cutoff’s sensitivity (true positives / (total # of observations)) and specificity (true negatives / (total # of observations)), we can then visualize the effectiveness of every possible cutoff.</p> <p>tdlr: we want a cutoff with <strong>high sensitivity</strong> and <strong>high specificity</strong>.</p> <div class="col-sm"> #calculate sensiticity and specificity for each cutoff of each biomarker output_WB &lt;- map_dfr(compounds_WB, ~ sens_spec_cpd( dataset = WB, cpd = all_of(.x), timepoints = timepoints_WB )) |&gt; clean_gluc() output_BR &lt;- map_dfr(compounds_BR, ~ sens_spec_cpd( dataset = BR, cpd = all_of(.x), timepoints = timepoints_BR )) |&gt; clean_gluc() output_OF &lt;- map_dfr(compounds_OF, ~ sens_spec_cpd( dataset = OF, cpd = all_of(.x), timepoints = timepoints_OF )) |&gt; clean_gluc() #plotting ss_bottom_row &lt;- plot_grid( ss_OF, ss_BR, labels = c('B', 'C'), label_size = 12, ncol = 2, rel_widths = c(0.66, .33) ) plot_grid( ss_WB, ss_bottom_row, labels = c('A', ''), label_size = 12, ncol = 1 ) </div> <p><img src="_projects\cs01assets\DLvsSS.png" alt=""></p> <p>Here we see the sensitivity of every possible cutoff at different time windows. We as a team decided that the cutoffs should be judged upon their average sensiticity and specificity. (Although, in hindsight, it might’ve been a good idea to base our analysis solely on the ealier time windows - we are trying to detect <em>recent</em> canibis use after all.) Plotting the average sensitivity and specificity of each cutoff, we get:</p> <p>Whole blood: <img src="_projects\cs01assets\avgSS.png" alt=""> Oral fluid: <img src="_projects\cs01assets\avgSSOF.png" alt=""> Breath: <img src="_projects\cs01assets\avgSSBR.png" alt=""></p> <p>It should be apparent that OF-THC and WB-THC are the superior choices. The average sensitivity and specificity intersects at some cutoffs, meaning at that point, both the sensitivity and specificity is maximized. Additionally, if we eye ball their point of intersection, OF-THC has a significantly higher sensitivity and specificity at that point, making it the most optimal biomarker.</p> <p>Now we investigate OF-THC further to find the specific cutoff. In short, we basically zoom in on the graph. Giving us:</p> <p><img src="_projects\cs01assets\OFTHCzoomed.png" alt=""></p> <ul> <li>and the specific detection limit:</li> </ul> <div class="col-sm"> output_OF_avg |&gt; mutate(diff = abs(average_sensitivity-average_specificity)) |&gt; arrange(diff) </div> <p>## # A tibble: 101 × 5 ## compound detection_limit average_sensitivity average_specificity diff ## <chr> <dbl> <dbl> <dbl> <dbl> ## 1 THC 0.82 0.893 0.890 0.00338 ## 2 THC 0.84 0.893 0.890 0.00338 ## 3 THC 0.86 0.893 0.890 0.00338 ## 4 THC 0.88 0.893 0.890 0.00338 ## 5 THC 0.9 0.893 0.890 0.00338 ## 6 THC 0.7 0.903 0.879 0.0240 ## 7 THC 0.72 0.903 0.879 0.0240 ## 8 THC 0.74 0.903 0.879 0.0240 ## 9 THC 0.76 0.903 0.879 0.0240 ## 10 THC 0.78 0.903 0.879 0.0240 ## # ℹ 91 more rows</dbl></dbl></dbl></dbl></chr></p> <p>At the cutoff range of 0.82 to 0.90, the difference between the average sensitivity and average specificity is minimized. We will settle with <strong>&gt;0.85ng/mL of THC in oral fluid</strong> sample as the final detection limit.</p> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Rainer Zhang. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. Last updated: April 11, 2024. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?9b43d6e67ddc7c0855b1478ee4c48c2d" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>